# RAG μ‹μ¤ν… ν„ν™© λ° μ™„μ„±λ„ ν‰κ°€

- **μ‘μ„± μΌμ‹:** 2025-11-24 04:40 (KST)
- **λ©μ :** ν„μ¬ RAG μ‹μ¤ν…μ κµ¬ν„ μƒνƒμ™€ μ‚¬μ© κ°€λ¥ μ—¬λ¶€ ν‰κ°€

---

## π“ μ§λ¬Έ 1: RAGAS ν‰κ°€ + νμΈνλ‹ ν›„ = μ™„μ„±?

### ν„μ¬ μƒν™©

**μ™„λ£λ λ‹¨κ³„:**
1. β… λ¬Έμ„ μ „μ²λ¦¬ λ° μ²­ν‚Ή (3,719κ° μ²­ν¬)
2. β… μ„λ² λ”© λ¨λΈ μ„ μ • (BGE-m3)
3. β… λ²΅ν„° DB κµ¬μ¶• (ChromaDB)
4. β… κ²€μƒ‰ μ „λµ μµμ ν™” (BM25 Only + Okt)
5. β… LLM λ¨λΈ μ„ μ • (Bllossom-8B)
6. π”„ RAGAS ν‰κ°€ (μ§„ν–‰ μ¤‘, 300/2,223κ° μ™„λ£)

**λ‚¨μ€ λ‹¨κ³„:**
7. βΈοΈ μ„λ² λ”© λ¨λΈ νμΈνλ‹
8. βΈοΈ λ¦¬λ­μ»¤ νμΈνλ‹
9. βΈοΈ νμΈνλ‹ ν›„ μ¬ν‰κ°€
10. βΈοΈ **ν†µν•© RAG μ‹μ¤ν… κµ¬μ¶•** β οΈ **μ¤‘μ”!**

### λ‹µλ³€: **μ•„λ‹μ”, μ•„μ§ μ™„μ„±λμ§€ μ•μ•μµλ‹λ‹¤**

**μ΄μ :**
- νμΈνλ‹κΉμ§€ μ™„λ£ν•΄λ„, **μ‹¤μ λ΅ μ‚¬μ© κ°€λ¥ν• ν†µν•© μ‹μ¤ν…(API μ„λ²„ λλ” λ©”μΈ ν΄λμ¤)μ΄ μ•„μ§ μ—†μµλ‹λ‹¤**
- ν„μ¬λ” κ° λ‹¨κ³„λ³„ **ν‰κ°€/λ²¤μΉλ§ν¬ μ¤ν¬λ¦½νΈ**λ§ μ΅΄μ¬ν•©λ‹λ‹¤
- μ‚¬μ©μκ°€ μ§λ¬Έμ„ λ„£κ³  λ‹µλ³€μ„ λ°›λ” **End-to-End μ‹μ¤ν…**μ΄ ν•„μ”ν•©λ‹λ‹¤

### μ™„μ„±μ„ μ„ν• μ¶”κ°€ μ‘μ—… ν•„μ”

#### ν•„μ μ‘μ—…: ν†µν•© RAG μ‹μ¤ν… κµ¬μ¶•
- **λ©μ :** κ²€μƒ‰(Retrieval) + μƒμ„±(Generation)μ„ ν•λ‚μ ν΄λμ¤/APIλ΅ ν†µν•©
- **κµ¬ν„ λ‚΄μ©:**
  - `HistoryDocent` λ©”μΈ ν΄λμ¤ μ‘μ„±
  - μ‚¬μ©μ μ§λ¬Έ μ…λ ¥ β†’ κ²€μƒ‰ β†’ λ‹µλ³€ μƒμ„± β†’ λ°ν™
  - (μ„ νƒ) FastAPI/Streamlitμ„ ν™μ©ν• μ›Ή μΈν„°νμ΄μ¤

#### μ„ νƒμ  μ‘μ—…: API μ„λ²„ κµ¬μ¶•
- **λ©μ :** μ‹¤μ  μ„λΉ„μ¤ ν™κ²½μ—μ„ μ‚¬μ© κ°€λ¥ν•λ„λ΅
- **κµ¬ν„ λ‚΄μ©:**
  - FastAPI REST API μ„λ²„
  - `/query` μ—”λ“ν¬μΈνΈ (POST)
  - μ”μ²­/μ‘λ‹µ λ΅κΉ… λ° λ¨λ‹ν„°λ§

---

## π“ μ§λ¬Έ 2: μ§€κΈ λ°”λ΅ RAG μ‹μ¤ν…μ„ μ‚¬μ©ν•  μ μλ‚?

### ν„μ¬ μƒνƒ

**μ‚¬μ© κ°€λ¥ν• μ»΄ν¬λ„νΈ:**
- β… `05_Retrieval_Optimization/retrieval_system.py`: κ²€μƒ‰ μ‹μ¤ν… (Retrievalλ§)
- β… `06_LLM_Evaluation/test_selected_model.py`: ν‰κ°€μ© μ¤ν¬λ¦½νΈ (μΌκ΄„ μ²λ¦¬μ©)
- β… `prepare_ragas_data.py`: RAGAS ν‰κ°€ μ¤€λΉ„ μ¤ν¬λ¦½νΈ

**μ‚¬μ© λ¶κ°€λ¥ν• κ²ƒ:**
- β ν†µν•© RAG ν΄λμ¤ (κ²€μƒ‰ + μƒμ„±)
- β API μ„λ²„
- β κ°„λ‹¨ν• μ§μμ‘λ‹µ μ¤ν¬λ¦½νΈ

### λ‹µλ³€: **μ•„λ‹μ”, λ°”λ΅ μ‚¬μ©ν•  μ μ—†μµλ‹λ‹¤**

**μ΄μ :**
1. ν„μ¬ κ° μ»΄ν¬λ„νΈκ°€ **λ¶„λ¦¬λμ–΄** μμµλ‹λ‹¤
   - κ²€μƒ‰ μ‹μ¤ν…κ³Ό LLM μƒμ„± μ‹μ¤ν…μ΄ μ—°κ²°λμ–΄ μμ§€ μ•μ
2. `test_selected_model.py`λ” **ν‰κ°€μ© μΌκ΄„ μ²λ¦¬ μ¤ν¬λ¦½νΈ**μ…λ‹λ‹¤
   - κ°λ³„ μ§λ¬Έμ„ μ…λ ¥λ°›μ•„ μ¦‰μ‹ λ‹µλ³€ν•λ” κΈ°λ¥ μ—†μ
3. ν†µν•© μΈν„°νμ΄μ¤κ°€ μ—†μµλ‹λ‹¤
   - μ‚¬μ©μκ°€ "ν• λ²μ ν•¨μ νΈμ¶"λ΅ μ§λ¬Έβ†’λ‹µλ³€μ„ λ°›μ„ μ μ—†μ

### ν„μ¬ κ°€λ¥ν• μ‘μ—…

**μ„μ‹ λ°©λ²• (μλ™ ν†µν•©):**
```python
# 1. κ²€μƒ‰ μ‹μ¤ν… μ΄κΈ°ν™”
from retrieval_system import RetrievalSystem
retriever = RetrievalSystem()
retriever.initialize()

# 2. κ²€μƒ‰ μν–‰
results = retriever.search("μ†κΈ°μ •μ€ λ„κµ¬μΈκ°€?")

# 3. LLMμ— μ§μ ‘ μ „λ‹¬ (μλ™μΌλ΅ ν”„λ΅¬ν”„νΈ μ‘μ„± ν•„μ”)
# ... (μ½”λ“ μ‘μ„± ν•„μ”)
```

μ΄ λ°©λ²•μ€ **λ§¤μ° λ¶νΈ**ν•κ³  **ν”„λ΅¬ν”„νΈ κ΄€λ¦¬λ„ μλ™**μ…λ‹λ‹¤.

---

## β… μ™„μ„±λ RAG μ‹μ¤ν…μ„ μ„ν• λ΅λ“λ§µ

### λ‹¨κ³„λ³„ μ™„μ„±λ„

| λ‹¨κ³„ | μ‘μ—… λ‚΄μ© | μƒνƒ | μ™„μ„±λ„ |
|:---|:---|:---:|:---:|
| 1 | λ¬Έμ„ μ „μ²λ¦¬ λ° μ²­ν‚Ή | β… μ™„λ£ | 100% |
| 2 | μ„λ² λ”© λ¨λΈ μ„ μ • | β… μ™„λ£ | 100% |
| 3 | λ²΅ν„° DB κµ¬μ¶• | β… μ™„λ£ | 100% |
| 4 | κ²€μƒ‰ μ „λµ μµμ ν™” | β… μ™„λ£ | 100% |
| 5 | LLM λ¨λΈ μ„ μ • | β… μ™„λ£ | 100% |
| 6 | RAGAS ν‰κ°€ | π”„ μ§„ν–‰ μ¤‘ | 13.5% |
| 7 | **ν†µν•© RAG μ‹μ¤ν… κµ¬μ¶•** | βΈοΈ λ―Έμ™„λ£ | **0%** |
| 8 | μ„λ² λ”© νμΈνλ‹ | βΈοΈ λ€κΈ° | 0% |
| 9 | λ¦¬λ­μ»¤ νμΈνλ‹ | βΈοΈ λ€κΈ° | 0% |
| 10 | νμΈνλ‹ ν›„ μ¬ν‰κ°€ | βΈοΈ λ€κΈ° | 0% |
| 11 | API μ„λ²„ κµ¬μ¶• (μ„ νƒ) | βΈοΈ λ―Έμ™„λ£ | 0% |

### μµμΆ… μ™„μ„±λ„λ¥Ό μ„ν• 3κ°€μ§€ μµμ…

#### μµμ… 1: μµμ† μ™„μ„± (μ·¨μ—… ν¬νΈν΄λ¦¬μ¤μ©) β­ μ¶”μ²
**μ™„λ£ μ΅°κ±΄:**
1. β… RAGAS ν‰κ°€ μ™„λ£ (μ§„ν–‰ μ¤‘)
2. β… ν†µν•© RAG ν΄λμ¤ κµ¬μ¶• (ν•„μ)
3. βΈοΈ νμΈνλ‹ (μ„ νƒ - Baseline μ μλ§ μμ–΄λ„ ν¬νΈν΄λ¦¬μ¤ κ°€λ¥)

**μμƒ μ†μ” μ‹κ°„:** 2-3μ‹κ°„ (ν†µν•© μ‹μ¤ν… κµ¬μ¶•)

#### μµμ… 2: μ¤‘κ°„ μ™„μ„± (μ„±λ¥ κ°μ„  ν¬ν•¨)
**μ™„λ£ μ΅°κ±΄:**
1. β… RAGAS ν‰κ°€ μ™„λ£ (μ§„ν–‰ μ¤‘)
2. β… ν†µν•© RAG ν΄λμ¤ κµ¬μ¶• (ν•„μ)
3. β… μ„λ² λ”©/λ¦¬λ­μ»¤ νμΈνλ‹ (ν•„μ)
4. β… νμΈνλ‹ ν›„ μ¬ν‰κ°€ (ν•„μ)

**μμƒ μ†μ” μ‹κ°„:** RAGAS ν‰κ°€ + νμΈνλ‹ + μ¬ν‰κ°€ = μ•½ 1μ£ΌμΌ

#### μµμ… 3: μ™„μ „ν• μ™„μ„± (μ‹¤μ  μ„λΉ„μ¤ μμ¤€)
**μ™„λ£ μ΅°κ±΄:**
1. β… μµμ… 2μ λ¨λ“  μ΅°κ±΄
2. β… API μ„λ²„ κµ¬μ¶• (FastAPI)
3. β… μ›Ή μΈν„°νμ΄μ¤ (Streamlit λλ” React)
4. β… λ¨λ‹ν„°λ§ λ° λ΅κΉ… μ‹μ¤ν…

**μμƒ μ†μ” μ‹κ°„:** μµμ… 2 + API μ„λ²„ = μ•½ 2μ£ΌμΌ

---

## π― κ¶μ¥ μ‚¬ν•­

### μ·¨μ—… ν¬νΈν΄λ¦¬μ¤ κ΄€μ 

**ν„μ¬κΉμ§€ μ™„λ£λ κ²ƒ:**
- β… λ°μ΄ν„° κΈ°λ° μμ‚¬κ²°μ • κ³Όμ • μ™„λ²½ν•κ² λ¬Έμ„ν™”
- β… κ° λ‹¨κ³„λ³„ λ²¤μΉλ§ν¬ λ° λΉ„κµ μ‹¤ν— μ™„λ£
- β… μ •λ‰/μ •μ„± ν‰κ°€ λ³‘ν–‰
- π”„ RAGAS ν‰κ°€ μ§„ν–‰ μ¤‘ (κ°κ΄€μ  μ„±λ¥ μ§€ν‘ ν™•λ³΄ μμ •)

**μ¶”κ°€λ΅ ν•„μ”ν• κ²ƒ:**
1. **ν†µν•© RAG ν΄λμ¤ κµ¬μ¶•** (2-3μ‹κ°„)
   - "μ°λ¦¬ μ‹μ¤ν…μ„ μ‚¬μ©ν•λ ¤λ©΄ μ΄λ ‡κ² ν•μ„Έμ”" λ°λ¨ μ½”λ“
2. **κ°„λ‹¨ν• μ‚¬μ© μμ ** (1μ‹κ°„)
   - Jupyter Notebook λλ” Python μ¤ν¬λ¦½νΈ
3. **νμΈνλ‹** (μ„ νƒ - μ‹κ°„μ΄ μμΌλ©΄)
   - Before/After λΉ„κµλ΅ μ„±λ¥ κ°μ„  μ¦λ…

### κ²°λ΅ 

**RAGAS ν‰κ°€ + νμΈνλ‹ β‰  μ™„μ„±**

**μ™„μ„±μ„ μ„ν•΄μ„λ”:**
- β… RAGAS ν‰κ°€ (ν„μ¬ μ§„ν–‰ μ¤‘)
- β… ν†µν•© RAG μ‹μ¤ν… κµ¬μ¶• (ν•„μ)
- βΈοΈ νμΈνλ‹ (μ„ νƒ - ν¬νΈν΄λ¦¬μ¤μ—μ„λ” Baseline μ μλ„ μ¶©λ¶„)

**μ§€κΈ λ°”λ΅ μ‚¬μ© κ°€λ¥ν•κ°€?**
- β μ•„λ‹μ”. ν†µν•© μ‹μ¤ν…μ„ κµ¬μ¶•ν•΄μ•Ό ν•©λ‹λ‹¤.
- ν•μ§€λ§ κ° μ»΄ν¬λ„νΈλ” λ¨λ‘ μ¤€λΉ„λμ–΄ μμ–΄μ„, **2-3μ‹κ°„μ΄λ©΄ ν†µν•© μ‹μ¤ν…μ„ λ§λ“¤ μ μμµλ‹λ‹¤**.

---

## π“ λ‹¤μ λ‹¨κ³„ μ μ•

### μ¦‰μ‹ μ§„ν–‰ κ°€λ¥ (RAGAS ν‰κ°€μ™€ λ³‘ν–‰)

**1. ν†µν•© RAG ν΄λμ¤ μ‘μ„±** (`HistoryDocent` ν΄λμ¤)
```python
class HistoryDocent:
    def __init__(self):
        # κ²€μƒ‰ μ‹μ¤ν… μ΄κΈ°ν™”
        # LLM λ¨λΈ μ΄κΈ°ν™”
    
    def query(self, question: str) -> str:
        # κ²€μƒ‰ β†’ λ‹µλ³€ μƒμ„± β†’ λ°ν™
```

**2. κ°„λ‹¨ν• μ‚¬μ© μμ  μ‘μ„±**
```python
docent = HistoryDocent()
answer = docent.query("μ†κΈ°μ •μ€ λ„κµ¬μΈκ°€?")
print(answer)
```

### RAGAS ν‰κ°€ μ™„λ£ ν›„

**3. νμΈνλ‹ (μ„ νƒ)**
- Baseline μ μκ°€ λ‚®μ€ μ§€ν‘ κΈ°μ¤€μΌλ΅ νμΈνλ‹ λ€μƒ κ²°μ •
- μ: Context Recallμ΄ λ‚®μΌλ©΄ β†’ μ„λ² λ”© νμΈνλ‹

**4. νμΈνλ‹ ν›„ μ¬ν‰κ°€**
- Before/After λΉ„κµ

---

**μ‘μ„±μ:** AI Assistant  
**μµμΆ… μ—…λ°μ΄νΈ:** 2025-11-24 04:40 (KST)

